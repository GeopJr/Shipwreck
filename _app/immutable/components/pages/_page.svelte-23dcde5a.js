import{S as ue,i as ce,s as fe,k as p,q as B,a as T,l as h,m,r as R,h as d,c as J,n as b,I as M,p as W,b as pe,G as a,J as P,K as H,A as ne,L as he}from"../../chunks/index-c18d4107.js";/* empty css                            */var re=function n(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var l,r,s;if(Array.isArray(t)){if(l=t.length,l!=e.length)return!1;for(r=l;r--!==0;)if(!n(t[r],e[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if(s=Object.keys(t),l=s.length,l!==Object.keys(e).length)return!1;for(r=l;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[r]))return!1;for(r=l;r--!==0;){var o=s[r];if(!n(t[o],e[o]))return!1}return!0}return t!==t&&e!==e};const se={string:"String",boolean:"Bool",int:"Int64",float:"Float64",undefined:"Nil"},de=["abstract","do","if","nil?","select","union","alias","else","in","of","self","unless","as","elsif","include","out","sizeof","until","as?","end","instance_sizeof","pointerof","struct","verbatim","asm","ensure","is_a?","private","super","when","begin","enum","lib","protected","then","while","break","extend","macro","require","true","with","case","false","module","rescue","type","yield","class","for","next","responds_to?","typeof","def","fun","nil","return","uninitialized"];function _e(n,t=!1){const e=Object.entries(JSON.parse(n));if(e.length===0)return"";const l={};function r(i){l[i.name]=i.value}ae(e,r);let s=Object.entries(l);t&&(s=ie(s));const o=[],y=new Map;for(let i=0;i<s.length;i++){const j=["struct "+s[i][0],`	include JSON::Serializable
`],_=Object.entries(s[i][1]);for(let v=0;v<_.length;v++){let c=_[v][0],A=!1;ge(c)||(j.push(`	@[JSON::Field(key: ${JSON.stringify(c)})]`),c="n_"+(y.has(c)?y.get(c):y.set(c,Z()).get(c)),A=!0),j.push(`	property ${c} : ${_[v][1]}${A?`
`:""}`)}j.push("end"),o.push(j.join(`
`))}return o.join(`
`)}function ae(n,t,e=!1,l=Z()){let r={};for(let s=0;s<n.length;s++)r[n[s][0]]=oe(n[s][1],t);t({name:(e?"T_":"O_")+l,value:r})}function oe(n,t){let e=typeof n;if(e==="number")e=n===parseInt(n)?"int":"float",e=se[e.toLowerCase()];else if(e==="object"&&n!=null){const l=typeof n.push=="function",r=Z();l?e=ve(n,t):(ae(Object.entries(n),t,!0,r),e="T_"+r)}else n==null&&(e="undefined"),e=se[e.toLowerCase()];return e}function ve(n,t){let e=[];for(let l=0;l<n.length;l++)e.push(oe(n[l],t));return e=[...new Set(e)],e=e.join("|"),"Array("+e+")"}function ge(n){return/^[a-z][a-zA-Z_0-9]*$/.test(n)&&!de.includes(n.toLowerCase())}function Z(){return Math.round(new Date().valueOf()*Math.random()).toString(36)}function ie(n){let t=n.filter(r=>r);const e={};for(let r=0;r<t.length;r++){const s=[];for(let o=r+1;o<t.length;o++)re(t[r][1],t[o][1])&&(s.push(t[o][0]),delete t[o],t=t.filter(y=>y));s.length>0&&(e[t[r][0]]=s)}const l=Object.entries(e);for(let r=0;r<Object.keys(l).length;r++)for(let s=0;s<l[r][1].length;s++)t=me(t,l[r][1][s],l[r][0]);return re(n,t)||(t=ie(t)),t}function me(n,t,e){const l=n;for(let r=0;r<l.length;r++)Object.entries(l[r][1]).forEach(s=>{s[1]===t?l[r][1][s[0]]=e:s[1].includes(t)&&(l[r][1][s[0]]=s[1].replace(t,e))});return l}function ye(n){let t,e,l,r,s,o,y,i,j,_,v,c,A,N,u,E,g,O,I,F,k,G,w,U,L,X,Q;return{c(){t=p("main"),e=p("div"),l=p("div"),r=p("label"),s=p("h1"),o=B("Input"),y=T(),i=p("textarea"),j=T(),_=p("div"),v=p("label"),c=p("h1"),A=B("Output"),N=T(),u=p("textarea"),E=T(),g=p("div"),O=p("div"),I=p("label"),F=B(`Optimize:
						`),k=p("input"),G=T(),w=p("button"),U=B("Run on carc.in"),this.h()},l(f){t=h(f,"MAIN",{class:!0});var S=m(t);e=h(S,"DIV",{class:!0});var q=m(e);l=h(q,"DIV",{class:!0});var Y=m(l);r=h(Y,"LABEL",{});var z=m(r);s=h(z,"H1",{});var $=m(s);o=R($,"Input"),$.forEach(d),y=J(z),i=h(z,"TEXTAREA",{class:!0}),m(i).forEach(d),z.forEach(d),Y.forEach(d),j=J(q),_=h(q,"DIV",{class:!0});var D=m(_);v=h(D,"LABEL",{});var C=m(v);c=h(C,"H1",{});var x=m(c);A=R(x,"Output"),x.forEach(d),N=J(C),u=h(C,"TEXTAREA",{class:!0}),m(u).forEach(d),C.forEach(d),E=J(D),g=h(D,"DIV",{class:!0});var V=m(g);O=h(V,"DIV",{style:!0});var ee=m(O);I=h(ee,"LABEL",{class:!0});var K=m(I);F=R(K,`Optimize:
						`),k=h(K,"INPUT",{style:!0,type:!0,title:!0}),K.forEach(d),ee.forEach(d),G=J(V),w=h(V,"BUTTON",{class:!0,title:!0});var te=m(w);U=R(te,"Run on carc.in"),te.forEach(d),V.forEach(d),D.forEach(d),q.forEach(d),S.forEach(d),this.h()},h(){b(i,"class","bigInput svelte-1odwk14"),M(i,"error",n[3]),b(l,"class","column svelte-1odwk14"),u.readOnly=!0,b(u,"class","bigInput svelte-1odwk14"),M(u,"error",n[3]),W(k,"align-self","center"),b(k,"type","checkbox"),b(k,"title","Optimization will merge similar structs. Making it smaller but also more difficult to maintain."),b(I,"class","optimizeText svelte-1odwk14"),W(O,"display","flex"),W(O,"align-content","center"),w.disabled=L=n[3]||n[0].length===0||n[2]||n[4].length===0,b(w,"class","carcBtn svelte-1odwk14"),b(w,"title","WARNING: This will send the input to carc.in, please remove private info beforehand."),b(g,"class","actions svelte-1odwk14"),b(_,"class","column svelte-1odwk14"),b(e,"class","overlay svelte-1odwk14"),b(t,"class","svelte-1odwk14")},m(f,S){pe(f,t,S),a(t,e),a(e,l),a(l,r),a(r,s),a(s,o),a(r,y),a(r,i),P(i,n[0]),a(e,j),a(e,_),a(_,v),a(v,c),a(c,A),a(v,N),a(v,u),P(u,n[4]),a(_,E),a(_,g),a(g,O),a(O,I),a(I,F),a(I,k),k.checked=n[1],a(g,G),a(g,w),a(w,U),X||(Q=[H(i,"input",n[6]),H(u,"input",n[7]),H(k,"change",n[8]),H(w,"click",n[9])],X=!0)},p(f,[S]){S&1&&P(i,f[0]),S&8&&M(i,"error",f[3]),S&16&&P(u,f[4]),S&8&&M(u,"error",f[3]),S&2&&(k.checked=f[1]),S&29&&L!==(L=f[3]||f[0].length===0||f[2]||f[4].length===0)&&(w.disabled=L)},i:ne,o:ne,d(f){f&&d(t),X=!1,he(Q)}}}function le(n){let t=!0;try{const e=JSON.parse(n);(typeof e.push=="function"||typeof e!="object")&&(t=!1)}catch{t=!1}return t}function Oe(n,t,e){let l,r,s="",o=!0,y=!1;function i(N){var g,O;const u=(O=(g=N.match(/struct (?<struct>O_.+)\n/))==null?void 0:g.groups)==null?void 0:O.struct,E=['require "json"',`${N}`];return E.push(`input = <<-JSON
${JSON.stringify(JSON.parse(s))}
JSON`),E.push(`pp ${u}.from_json(input)`),E.join(`

`)}async function j(N){var E,g;e(2,y=!0);const u=await fetch("https://play.crystal-lang.org/run_requests",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({run_request:{language:"crystal",version:"1.1.1",code:i(N)}})}).then(O=>O.json());e(2,y=!1),(g=(E=u==null?void 0:u.run_request)==null?void 0:E.run)!=null&&g.html_url&&window.open(u.run_request.run.html_url,"_blank").focus()}function _(){s=this.value,e(0,s)}function v(){l=this.value,e(4,l),e(0,s),e(1,o)}function c(){o=this.checked,e(1,o)}const A=()=>j(l);return n.$$.update=()=>{n.$$.dirty&3&&e(4,l=s.length>0&&le(s)?_e(s,o):s.length===0?"":"Invalid JSON"),n.$$.dirty&1&&e(3,r=s.length>0&&!le(s))},[s,o,y,r,l,j,_,v,c,A]}class Se extends ue{constructor(t){super(),ce(this,t,Oe,ye,fe,{})}}export{Se as default};
