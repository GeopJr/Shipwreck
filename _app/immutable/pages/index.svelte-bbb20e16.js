import{S as ue,i as ce,s as fe,e as d,t as C,k as x,c as p,a as _,h as R,d as h,m as T,b as w,L as V,f as K,g as de,K as o,M,N as H,n as re,O as pe}from"../chunks/index-709f8876.js";/* empty css                         */var ne=function r(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var l,n,s;if(Array.isArray(t)){if(l=t.length,l!=e.length)return!1;for(n=l;n--!==0;)if(!r(t[n],e[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if(s=Object.keys(t),l=s.length,l!==Object.keys(e).length)return!1;for(n=l;n--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[n]))return!1;for(n=l;n--!==0;){var a=s[n];if(!r(t[a],e[a]))return!1}return!0}return t!==t&&e!==e};const se={string:"String",boolean:"Bool",int:"Int64",float:"Float64",undefined:"Nil"},he=["abstract","do","if","nil?","select","union","alias","else","in","of","self","unless","as","elsif","include","out","sizeof","until","as?","end","instance_sizeof","pointerof","struct","verbatim","asm","ensure","is_a?","private","super","when","begin","enum","lib","protected","then","while","break","extend","macro","require","true","with","case","false","module","rescue","type","yield","class","for","next","responds_to?","typeof","def","fun","nil","return","uninitialized"];function ge(r,t=!1){const e=Object.entries(JSON.parse(r));if(e.length===0)return"";const l={};function n(i){l[i.name]=i.value}oe(e,n);let s=Object.entries(l);t&&(s=ie(s));const a=[],b=new Map;for(let i=0;i<s.length;i++){const O=["struct "+s[i][0],`	include JSON::Serializable
`],g=Object.entries(s[i][1]);for(let v=0;v<g.length;v++){let c=g[v][0],N=!1;me(c)||(O.push(`	@[JSON::Field(key: ${JSON.stringify(c)})]`),c="n_"+(b.has(c)?b.get(c):b.set(c,W()).get(c)),N=!0),O.push(`	property ${c} : ${g[v][1]}${N?`
`:""}`)}O.push("end"),a.push(O.join(`
`))}return a.join(`
`)}function oe(r,t,e=!1,l=W()){let n={};for(let s=0;s<r.length;s++)n[r[s][0]]=ae(r[s][1],t);t({name:(e?"T_":"O_")+l,value:n})}function ae(r,t){let e=typeof r;if(e==="number")e=r===parseInt(r)?"int":"float",e=se[e.toLowerCase()];else if(e==="object"&&r!=null){const l=typeof r.push=="function",n=W();l?e=ve(r,t):(oe(Object.entries(r),t,!0,n),e="T_"+n)}else r==null&&(e="undefined"),e=se[e.toLowerCase()];return e}function ve(r,t){let e=[];for(let l=0;l<r.length;l++)e.push(ae(r[l],t));return e=[...new Set(e)],e=e.join("|"),"Array("+e+")"}function me(r){return/^[a-z][a-zA-Z_0-9]*$/.test(r)&&!he.includes(r.toLowerCase())}function W(){return Math.round(new Date().valueOf()*Math.random()).toString(36)}function ie(r){let t=r.filter(n=>n);const e={};for(let n=0;n<t.length;n++){const s=[];for(let a=n+1;a<t.length;a++)ne(t[n][1],t[a][1])&&(s.push(t[a][0]),delete t[a],t=t.filter(b=>b));s.length>0&&(e[t[n][0]]=s)}const l=Object.entries(e);for(let n=0;n<Object.keys(l).length;n++)for(let s=0;s<l[n][1].length;s++)t=_e(t,l[n][1][s],l[n][0]);return ne(r,t)||(t=ie(t)),t}function _e(r,t,e){const l=r;for(let n=0;n<l.length;n++)Object.entries(l[n][1]).forEach(s=>{s[1]===t?l[n][1][s[0]]=e:s[1].includes(t)&&(l[n][1][s[0]]=s[1].replace(t,e))});return l}function be(r){let t,e,l,n,s,a,b,i,O,g,v,c,N,I,u,j,m,y,A,P,E,F,S,U,z,X,Z;return{c(){t=d("main"),e=d("div"),l=d("div"),n=d("label"),s=d("h1"),a=C("Input"),b=x(),i=d("textarea"),O=x(),g=d("div"),v=d("label"),c=d("h1"),N=C("Output"),I=x(),u=d("textarea"),j=x(),m=d("div"),y=d("div"),A=d("label"),P=C(`Optimize:
						`),E=d("input"),F=x(),S=d("button"),U=C("Run on carc.in"),this.h()},l(f){t=p(f,"MAIN",{class:!0});var k=_(t);e=p(k,"DIV",{class:!0});var J=_(e);l=p(J,"DIV",{class:!0});var Q=_(l);n=p(Q,"LABEL",{});var L=_(n);s=p(L,"H1",{});var Y=_(s);a=R(Y,"Input"),Y.forEach(h),b=T(L),i=p(L,"TEXTAREA",{class:!0}),_(i).forEach(h),L.forEach(h),Q.forEach(h),O=T(J),g=p(J,"DIV",{class:!0});var B=_(g);v=p(B,"LABEL",{});var q=_(v);c=p(q,"H1",{});var $=_(c);N=R($,"Output"),$.forEach(h),I=T(q),u=p(q,"TEXTAREA",{class:!0}),_(u).forEach(h),q.forEach(h),j=T(B),m=p(B,"DIV",{class:!0});var D=_(m);y=p(D,"DIV",{style:!0});var ee=_(y);A=p(ee,"LABEL",{class:!0});var G=_(A);P=R(G,`Optimize:
						`),E=p(G,"INPUT",{style:!0,type:!0,title:!0}),G.forEach(h),ee.forEach(h),F=T(D),S=p(D,"BUTTON",{class:!0,title:!0});var te=_(S);U=R(te,"Run on carc.in"),te.forEach(h),D.forEach(h),B.forEach(h),J.forEach(h),k.forEach(h),this.h()},h(){w(i,"class","bigInput svelte-1odwk14"),V(i,"error",r[3]),w(l,"class","column svelte-1odwk14"),u.readOnly=!0,w(u,"class","bigInput svelte-1odwk14"),V(u,"error",r[3]),K(E,"align-self","center"),w(E,"type","checkbox"),w(E,"title","Optimization will merge similar structs. Making it smaller but also more difficult to maintain."),w(A,"class","optimizeText svelte-1odwk14"),K(y,"display","flex"),K(y,"align-content","center"),S.disabled=z=r[3]||r[0].length===0||r[2]||r[4].length===0,w(S,"class","carcBtn svelte-1odwk14"),w(S,"title","WARNING: This will send the input to carc.in, please remove private info beforehand."),w(m,"class","actions svelte-1odwk14"),w(g,"class","column svelte-1odwk14"),w(e,"class","overlay svelte-1odwk14"),w(t,"class","svelte-1odwk14")},m(f,k){de(f,t,k),o(t,e),o(e,l),o(l,n),o(n,s),o(s,a),o(n,b),o(n,i),M(i,r[0]),o(e,O),o(e,g),o(g,v),o(v,c),o(c,N),o(v,I),o(v,u),M(u,r[4]),o(g,j),o(g,m),o(m,y),o(y,A),o(A,P),o(A,E),E.checked=r[1],o(m,F),o(m,S),o(S,U),X||(Z=[H(i,"input",r[6]),H(u,"input",r[7]),H(E,"change",r[8]),H(S,"click",r[9])],X=!0)},p(f,[k]){k&1&&M(i,f[0]),k&8&&V(i,"error",f[3]),k&16&&M(u,f[4]),k&8&&V(u,"error",f[3]),k&2&&(E.checked=f[1]),k&29&&z!==(z=f[3]||f[0].length===0||f[2]||f[4].length===0)&&(S.disabled=z)},i:re,o:re,d(f){f&&h(t),X=!1,pe(Z)}}}function le(r){let t=!0;try{const e=JSON.parse(r);(typeof e.push=="function"||typeof e!="object")&&(t=!1)}catch{t=!1}return t}function ye(r,t,e){let l,n,s="",a=!0,b=!1;function i(I){var m,y;const u=(y=(m=I.match(/struct (?<struct>O_.+)\n/))==null?void 0:m.groups)==null?void 0:y.struct,j=['require "json"',`${I}`];return j.push(`input = <<-JSON
${JSON.stringify(JSON.parse(s))}
JSON`),j.push(`pp ${u}.from_json(input)`),j.join(`

`)}async function O(I){var j,m;e(2,b=!0);const u=await fetch("https://play.crystal-lang.org/run_requests",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({run_request:{language:"crystal",version:"1.1.1",code:i(I)}})}).then(y=>y.json());e(2,b=!1),(m=(j=u==null?void 0:u.run_request)==null?void 0:j.run)!=null&&m.html_url&&window.open(u.run_request.run.html_url,"_blank").focus()}function g(){s=this.value,e(0,s)}function v(){l=this.value,e(4,l),e(0,s),e(1,a)}function c(){a=this.checked,e(1,a)}const N=()=>O(l);return r.$$.update=()=>{r.$$.dirty&3&&e(4,l=s.length>0&&le(s)?ge(s,a):s.length===0?"":"Invalid JSON"),r.$$.dirty&1&&e(3,n=s.length>0&&!le(s))},[s,a,b,n,l,O,g,v,c,N]}class ke extends ue{constructor(t){super();ce(this,t,ye,be,fe,{})}}export{ke as default};
