import{K as ne,S as ue,i as ce,s as fe,e as h,t as B,k as T,c as p,a as m,g as M,d,n as J,b as O,L as R,M as W,f as he,I as a,N as H,O as P,J as se,P as pe}from"../chunks/vendor-3a81be8b.js";/* empty css                         */const re={string:"String",boolean:"Bool",int:"Int64",float:"Float64",undefined:"Nil"},de=["abstract","do","if","nil?","select","union","alias","else","in","of","self","unless","as","elsif","include","out","sizeof","until","as?","end","instance_sizeof","pointerof","struct","verbatim","asm","ensure","is_a?","private","super","when","begin","enum","lib","protected","then","while","break","extend","macro","require","true","with","case","false","module","rescue","type","yield","class","for","next","responds_to?","typeof","def","fun","nil","return","uninitialized"];function _e(t,n=!1){const e=Object.entries(JSON.parse(t));if(e.length===0)return"";const l={};function r(i){l[i.name]=i.value}le(e,r);let s=Object.entries(l);n&&(s=ie(s));const o=[],b=new Map;for(let i=0;i<s.length;i++){const E=["struct "+s[i][0],`	include JSON::Serializable
`],_=Object.entries(s[i][1]);for(let g=0;g<_.length;g++){let c=_[g][0],k=!1;ve(c)||(E.push(`	@[JSON::Field(key: ${JSON.stringify(c)})]`),c="n_"+(b.has(c)?b.get(c):b.set(c,Z()).get(c)),k=!0),E.push(`	property ${c} : ${_[g][1]}${k?`
`:""}`)}E.push("end"),o.push(E.join(`
`))}return o.join(`
`)}function le(t,n,e=!1,l=Z()){let r={};for(let s=0;s<t.length;s++)r[t[s][0]]=ae(t[s][1],n);n({name:(e?"T_":"O_")+l,value:r})}function ae(t,n){let e=typeof t;if(e==="number")e=t===parseInt(t)?"int":"float",e=re[e.toLowerCase()];else if(e==="object"&&t!=null){const l=typeof t.push=="function",r=Z();l?e=ge(t,n):(le(Object.entries(t),n,!0,r),e="T_"+r)}else t==null&&(e="undefined"),e=re[e.toLowerCase()];return e}function ge(t,n){let e=[];for(let l=0;l<t.length;l++)e.push(ae(t[l],n));return e=[...new Set(e)],e=e.join("|"),"Array("+e+")"}function ve(t){return/^[a-z][a-zA-Z_0-9]*$/.test(t)&&!de.includes(t.toLowerCase())}function Z(){return Math.round(new Date().valueOf()*Math.random()).toString(36)}function ie(t){let n=t.filter(r=>r);const e={};for(let r=0;r<n.length;r++){const s=[];for(let o=r+1;o<n.length;o++)ne(n[r][1],n[o][1])&&(s.push(n[o][0]),delete n[o],n=n.filter(b=>b));s.length>0&&(e[n[r][0]]=s)}const l=Object.entries(e);for(let r=0;r<Object.keys(l).length;r++)for(let s=0;s<l[r][1].length;s++)n=me(n,l[r][1][s],l[r][0]);return ne(t,n)||(n=ie(n)),n}function me(t,n,e){const l=t;for(let r=0;r<l.length;r++)Object.entries(l[r][1]).forEach(s=>{s[1]===n?l[r][1][s[0]]=e:s[1].includes(n)&&(l[r][1][s[0]]=s[1].replace(n,e))});return l}function be(t){let n,e,l,r,s,o,b,i,E,_,g,c,k,w,u,S,v,y,A,F,I,U,N,X,L,G,Q;return{c(){n=h("main"),e=h("div"),l=h("div"),r=h("label"),s=h("h1"),o=B("Input"),b=T(),i=h("textarea"),E=T(),_=h("div"),g=h("label"),c=h("h1"),k=B("Output"),w=T(),u=h("textarea"),S=T(),v=h("div"),y=h("div"),A=h("label"),F=B(`Optimize:
						`),I=h("input"),U=T(),N=h("button"),X=B("Run on carc.in"),this.h()},l(f){n=p(f,"MAIN",{class:!0});var j=m(n);e=p(j,"DIV",{class:!0});var z=m(e);l=p(z,"DIV",{class:!0});var Y=m(l);r=p(Y,"LABEL",{});var D=m(r);s=p(D,"H1",{});var $=m(s);o=M($,"Input"),$.forEach(d),b=J(D),i=p(D,"TEXTAREA",{class:!0}),m(i).forEach(d),D.forEach(d),Y.forEach(d),E=J(z),_=p(z,"DIV",{class:!0});var q=m(_);g=p(q,"LABEL",{});var C=m(g);c=p(C,"H1",{});var x=m(c);k=M(x,"Output"),x.forEach(d),w=J(C),u=p(C,"TEXTAREA",{class:!0}),m(u).forEach(d),C.forEach(d),S=J(q),v=p(q,"DIV",{class:!0});var V=m(v);y=p(V,"DIV",{style:!0});var ee=m(y);A=p(ee,"LABEL",{class:!0});var K=m(A);F=M(K,`Optimize:
						`),I=p(K,"INPUT",{style:!0,type:!0,title:!0}),K.forEach(d),ee.forEach(d),U=J(V),N=p(V,"BUTTON",{class:!0,title:!0});var te=m(N);X=M(te,"Run on carc.in"),te.forEach(d),V.forEach(d),q.forEach(d),z.forEach(d),j.forEach(d),this.h()},h(){O(i,"class","bigInput svelte-1igr68f"),R(i,"error",t[3]),O(l,"class","column svelte-1igr68f"),u.readOnly=!0,O(u,"class","bigInput svelte-1igr68f"),R(u,"error",t[3]),W(I,"align-self","center"),O(I,"type","checkbox"),O(I,"title","Optimization will merge similar structs. Making it smaller but also more difficult to maintain."),O(A,"class","optimizeText svelte-1igr68f"),W(y,"display","flex"),W(y,"align-content","center"),N.disabled=L=t[3]||t[0].length===0||t[2]||t[4].length===0,O(N,"class","carcBtn svelte-1igr68f"),O(N,"title","WARNING: This will send the input to carc.in, please remove private info beforehand."),O(v,"class","actions svelte-1igr68f"),O(_,"class","column svelte-1igr68f"),O(e,"class","overlay svelte-1igr68f"),O(n,"class","svelte-1igr68f")},m(f,j){he(f,n,j),a(n,e),a(e,l),a(l,r),a(r,s),a(s,o),a(r,b),a(r,i),H(i,t[0]),a(e,E),a(e,_),a(_,g),a(g,c),a(c,k),a(g,w),a(g,u),H(u,t[4]),a(_,S),a(_,v),a(v,y),a(y,A),a(A,F),a(A,I),I.checked=t[1],a(v,U),a(v,N),a(N,X),G||(Q=[P(i,"input",t[6]),P(u,"input",t[7]),P(I,"change",t[8]),P(N,"click",t[9])],G=!0)},p(f,[j]){j&1&&H(i,f[0]),j&8&&R(i,"error",f[3]),j&16&&H(u,f[4]),j&8&&R(u,"error",f[3]),j&2&&(I.checked=f[1]),j&29&&L!==(L=f[3]||f[0].length===0||f[2]||f[4].length===0)&&(N.disabled=L)},i:se,o:se,d(f){f&&d(n),G=!1,pe(Q)}}}function oe(t){let n=!0;try{const e=JSON.parse(t);(typeof e.push=="function"||typeof e!="object")&&(n=!1)}catch{n=!1}return n}function ye(t,n,e){let l,r,s="",o=!0,b=!1;function i(w){var v,y;const u=(y=(v=w.match(/struct (?<struct>O_.+)\n/))==null?void 0:v.groups)==null?void 0:y.struct,S=['require "json"',`${w}`];return S.push(`input = <<-JSON
${JSON.stringify(JSON.parse(s))}
JSON`),S.push(`pp ${u}.from_json(input)`),S.join(`

`)}async function E(w){var S,v;e(2,b=!0);const u=await fetch("https://play.crystal-lang.org/run_requests",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({run_request:{language:"crystal",version:"1.1.1",code:i(w)}})}).then(y=>y.json());e(2,b=!1),!!((v=(S=u==null?void 0:u.run_request)==null?void 0:S.run)==null?void 0:v.html_url)&&window.open(u.run_request.run.html_url,"_blank").focus()}function _(){s=this.value,e(0,s)}function g(){l=this.value,e(4,l),e(0,s),e(1,o)}function c(){o=this.checked,e(1,o)}const k=()=>E(l);return t.$$.update=()=>{t.$$.dirty&3&&e(4,l=s.length>0&&oe(s)?_e(s,o):s.length===0?"":"Invalid JSON"),t.$$.dirty&1&&e(3,r=s.length>0&&!oe(s))},[s,o,b,r,l,E,_,g,c,k]}class je extends ue{constructor(n){super();ce(this,n,ye,be,fe,{})}}export{je as default};
