import{K as ne,S as ue,i as ce,s as fe,e as h,t as B,k as w,c as d,a as v,g as M,d as p,n as J,b,L as R,M as W,f as he,I as a,N as H,O as P,J as se,P as de}from"../chunks/vendor-6226dca4.js";/* empty css                         */const re={string:"String",boolean:"Bool",int:"Int64",float:"Float64",undefined:"Nil"};function pe(t,n=!1){const e=Object.entries(JSON.parse(t));if(e.length===0)return"";const l={};function r(i){l[i.name]=i.value}le(e,r);let s=Object.entries(l);n&&(s=ie(s));const o=[],m=new Map;for(let i=0;i<s.length;i++){const y=["struct "+s[i][0],`	include JSON::Serializable
`],_=Object.entries(s[i][1]);for(let g=0;g<_.length;g++){let u=_[g][0],N=!1;ge(u)||(y.push(`	@[JSON::Field(key: "${u}")]`),u="n_"+(m.has(u)?m.get(u):m.set(u,Z()).get(u)),N=!0),y.push(`	property ${u} : ${_[g][1]}${N?`
`:""}`)}y.push("end"),o.push(y.join(`
`))}return o.join(`
`)}function le(t,n,e=!1,l=Z()){let r={};for(let s=0;s<t.length;s++)r[t[s][0]]=ae(t[s][1],n);n({name:(e?"T_":"O_")+l,value:r})}function ae(t,n){let e=typeof t;if(e==="number")e=t===parseInt(t)?"int":"float",e=re[e.toLowerCase()];else if(e==="object"&&t!=null){const l=typeof t.push=="function",r=Z();l?e=_e(t,n):(le(Object.entries(t),n,!0,r),e="T_"+r)}else t==null&&(e="undefined"),e=re[e.toLowerCase()];return e}function _e(t,n){let e=[];for(let l=0;l<t.length;l++)e.push(ae(t[l],n));return e=[...new Set(e)],e=e.join("|"),"Array("+e+")"}function ge(t){return/^[a-z][a-zA-Z_0-9]*$/.test(t)}function Z(){return Math.round(new Date().valueOf()*Math.random()).toString(36)}function ie(t){let n=t.filter(r=>r);const e={};for(let r=0;r<n.length;r++){const s=[];for(let o=r+1;o<n.length;o++)ne(n[r][1],n[o][1])&&(s.push(n[o][0]),delete n[o],n=n.filter(m=>m));s.length>0&&(e[n[r][0]]=s)}const l=Object.entries(e);for(let r=0;r<Object.keys(l).length;r++)for(let s=0;s<l[r][1].length;s++)n=ve(n,l[r][1][s],l[r][0]);return ne(t,n)||(n=ie(n)),n}function ve(t,n,e){const l=t;for(let r=0;r<l.length;r++)Object.entries(l[r][1]).forEach(s=>{s[1]===n?l[r][1][s[0]]=e:s[1].includes(n)&&(l[r][1][s[0]]=s[1].replace(n,e))});return l}function me(t){let n,e,l,r,s,o,m,i,y,_,g,u,N,A,c,k,O,j,T,F,I,U,S,X,L,G,Q;return{c(){n=h("main"),e=h("div"),l=h("div"),r=h("label"),s=h("h1"),o=B("Input"),m=w(),i=h("textarea"),y=w(),_=h("div"),g=h("label"),u=h("h1"),N=B("Output"),A=w(),c=h("textarea"),k=w(),O=h("div"),j=h("div"),T=h("label"),F=B(`Optimize:
						`),I=h("input"),U=w(),S=h("button"),X=B("Run on carc.in"),this.h()},l(f){n=d(f,"MAIN",{class:!0});var E=v(n);e=d(E,"DIV",{class:!0});var D=v(e);l=d(D,"DIV",{class:!0});var Y=v(l);r=d(Y,"LABEL",{});var q=v(r);s=d(q,"H1",{});var $=v(s);o=M($,"Input"),$.forEach(p),m=J(q),i=d(q,"TEXTAREA",{class:!0}),v(i).forEach(p),q.forEach(p),Y.forEach(p),y=J(D),_=d(D,"DIV",{class:!0});var z=v(_);g=d(z,"LABEL",{});var C=v(g);u=d(C,"H1",{});var x=v(u);N=M(x,"Output"),x.forEach(p),A=J(C),c=d(C,"TEXTAREA",{class:!0}),v(c).forEach(p),C.forEach(p),k=J(z),O=d(z,"DIV",{class:!0});var V=v(O);j=d(V,"DIV",{style:!0});var ee=v(j);T=d(ee,"LABEL",{class:!0});var K=v(T);F=M(K,`Optimize:
						`),I=d(K,"INPUT",{style:!0,type:!0,title:!0}),K.forEach(p),ee.forEach(p),U=J(V),S=d(V,"BUTTON",{class:!0,title:!0});var te=v(S);X=M(te,"Run on carc.in"),te.forEach(p),V.forEach(p),z.forEach(p),D.forEach(p),E.forEach(p),this.h()},h(){b(i,"class","bigInput svelte-1igr68f"),R(i,"error",t[3]),b(l,"class","column svelte-1igr68f"),c.readOnly=!0,b(c,"class","bigInput svelte-1igr68f"),R(c,"error",t[3]),W(I,"align-self","center"),b(I,"type","checkbox"),b(I,"title","Optimization will merge similar structs. Making it smaller but also more difficult to maintain."),b(T,"class","optimizeText svelte-1igr68f"),W(j,"display","flex"),W(j,"align-content","center"),S.disabled=L=t[3]||t[0].length===0||t[2]||t[4].length===0,b(S,"class","carcBtn svelte-1igr68f"),b(S,"title","WARNING: This will send the input to carc.in, please remove private info beforehand."),b(O,"class","actions svelte-1igr68f"),b(_,"class","column svelte-1igr68f"),b(e,"class","overlay svelte-1igr68f"),b(n,"class","svelte-1igr68f")},m(f,E){he(f,n,E),a(n,e),a(e,l),a(l,r),a(r,s),a(s,o),a(r,m),a(r,i),H(i,t[0]),a(e,y),a(e,_),a(_,g),a(g,u),a(u,N),a(g,A),a(g,c),H(c,t[4]),a(_,k),a(_,O),a(O,j),a(j,T),a(T,F),a(T,I),I.checked=t[1],a(O,U),a(O,S),a(S,X),G||(Q=[P(i,"input",t[6]),P(c,"input",t[7]),P(I,"change",t[8]),P(S,"click",t[9])],G=!0)},p(f,[E]){E&1&&H(i,f[0]),E&8&&R(i,"error",f[3]),E&16&&H(c,f[4]),E&8&&R(c,"error",f[3]),E&2&&(I.checked=f[1]),E&29&&L!==(L=f[3]||f[0].length===0||f[2]||f[4].length===0)&&(S.disabled=L)},i:se,o:se,d(f){f&&p(n),G=!1,de(Q)}}}function oe(t){let n=!0;try{typeof JSON.parse(t).push=="function"&&(n=!1)}catch{n=!1}return n}function be(t,n,e){let l,r,s="",o=!0,m=!1;function i(A){var O,j;const c=(j=(O=A.match(/struct (?<struct>O_.+)\n/))==null?void 0:O.groups)==null?void 0:j.struct,k=['require "json"',`${A}`];return k.push(`
pp ${c}.from_json(%(${JSON.stringify(JSON.parse(s))}))`),k.join(`

`)}async function y(A){e(2,m=!0);const c=await fetch("https://play.crystal-lang.org/run_requests",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({run_request:{language:"crystal",version:"1.1.1",code:i(A)}})}).then(k=>k.json());e(2,m=!1),c.run_request.run.exit_code!==1&&window.open(c.run_request.run.html_url,"_blank").focus()}function _(){s=this.value,e(0,s)}function g(){l=this.value,e(4,l),e(0,s),e(1,o)}function u(){o=this.checked,e(1,o)}const N=()=>y(l);return t.$$.update=()=>{t.$$.dirty&3&&e(4,l=s.length>0&&oe(s)?pe(s,o):s.length===0?"":"Invalid JSON"),t.$$.dirty&1&&e(3,r=s.length>0&&!oe(s))},[s,o,m,r,l,y,_,g,u,N]}class Ee extends ue{constructor(n){super();ce(this,n,be,me,fe,{})}}export{Ee as default};
