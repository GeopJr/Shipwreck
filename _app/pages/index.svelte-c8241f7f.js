import{S as ue,i as ce,s as fe,e as p,t as V,k as J,c as h,a as m,h as B,d,m as k,b,L as M,f as W,g as pe,K as a,M as H,N as P,n as re,O as he}from"../chunks/index-03054b47.js";/* empty css                         */var ne=function r(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var l,n,s;if(Array.isArray(t)){if(l=t.length,l!=e.length)return!1;for(n=l;n--!==0;)if(!r(t[n],e[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if(s=Object.keys(t),l=s.length,l!==Object.keys(e).length)return!1;for(n=l;n--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[n]))return!1;for(n=l;n--!==0;){var i=s[n];if(!r(t[i],e[i]))return!1}return!0}return t!==t&&e!==e};const se={string:"String",boolean:"Bool",int:"Int64",float:"Float64",undefined:"Nil"},de=["abstract","do","if","nil?","select","union","alias","else","in","of","self","unless","as","elsif","include","out","sizeof","until","as?","end","instance_sizeof","pointerof","struct","verbatim","asm","ensure","is_a?","private","super","when","begin","enum","lib","protected","then","while","break","extend","macro","require","true","with","case","false","module","rescue","type","yield","class","for","next","responds_to?","typeof","def","fun","nil","return","uninitialized"];function ge(r,t=!1){const e=Object.entries(JSON.parse(r));if(e.length===0)return"";const l={};function n(o){l[o.name]=o.value}ae(e,n);let s=Object.entries(l);t&&(s=oe(s));const i=[],y=new Map;for(let o=0;o<s.length;o++){const j=["struct "+s[o][0],`	include JSON::Serializable
`],g=Object.entries(s[o][1]);for(let _=0;_<g.length;_++){let c=g[_][0],w=!1;ve(c)||(j.push(`	@[JSON::Field(key: ${JSON.stringify(c)})]`),c="n_"+(y.has(c)?y.get(c):y.set(c,Z()).get(c)),w=!0),j.push(`	property ${c} : ${g[_][1]}${w?`
`:""}`)}j.push("end"),i.push(j.join(`
`))}return i.join(`
`)}function ae(r,t,e=!1,l=Z()){let n={};for(let s=0;s<r.length;s++)n[r[s][0]]=ie(r[s][1],t);t({name:(e?"T_":"O_")+l,value:n})}function ie(r,t){let e=typeof r;if(e==="number")e=r===parseInt(r)?"int":"float",e=se[e.toLowerCase()];else if(e==="object"&&r!=null){const l=typeof r.push=="function",n=Z();l?e=_e(r,t):(ae(Object.entries(r),t,!0,n),e="T_"+n)}else r==null&&(e="undefined"),e=se[e.toLowerCase()];return e}function _e(r,t){let e=[];for(let l=0;l<r.length;l++)e.push(ie(r[l],t));return e=[...new Set(e)],e=e.join("|"),"Array("+e+")"}function ve(r){return/^[a-z][a-zA-Z_0-9]*$/.test(r)&&!de.includes(r.toLowerCase())}function Z(){return Math.round(new Date().valueOf()*Math.random()).toString(36)}function oe(r){let t=r.filter(n=>n);const e={};for(let n=0;n<t.length;n++){const s=[];for(let i=n+1;i<t.length;i++)ne(t[n][1],t[i][1])&&(s.push(t[i][0]),delete t[i],t=t.filter(y=>y));s.length>0&&(e[t[n][0]]=s)}const l=Object.entries(e);for(let n=0;n<Object.keys(l).length;n++)for(let s=0;s<l[n][1].length;s++)t=me(t,l[n][1][s],l[n][0]);return ne(r,t)||(t=oe(t)),t}function me(r,t,e){const l=r;for(let n=0;n<l.length;n++)Object.entries(l[n][1]).forEach(s=>{s[1]===t?l[n][1][s[0]]=e:s[1].includes(t)&&(l[n][1][s[0]]=s[1].replace(t,e))});return l}function ye(r){let t,e,l,n,s,i,y,o,j,g,_,c,w,I,u,E,v,O,T,F,A,U,N,X,L,G,Q;return{c(){t=p("main"),e=p("div"),l=p("div"),n=p("label"),s=p("h1"),i=V("Input"),y=J(),o=p("textarea"),j=J(),g=p("div"),_=p("label"),c=p("h1"),w=V("Output"),I=J(),u=p("textarea"),E=J(),v=p("div"),O=p("div"),T=p("label"),F=V(`Optimize:
						`),A=p("input"),U=J(),N=p("button"),X=V("Run on carc.in"),this.h()},l(f){t=h(f,"MAIN",{class:!0});var S=m(t);e=h(S,"DIV",{class:!0});var z=m(e);l=h(z,"DIV",{class:!0});var Y=m(l);n=h(Y,"LABEL",{});var q=m(n);s=h(q,"H1",{});var $=m(s);i=B($,"Input"),$.forEach(d),y=k(q),o=h(q,"TEXTAREA",{class:!0}),m(o).forEach(d),q.forEach(d),Y.forEach(d),j=k(z),g=h(z,"DIV",{class:!0});var D=m(g);_=h(D,"LABEL",{});var C=m(_);c=h(C,"H1",{});var x=m(c);w=B(x,"Output"),x.forEach(d),I=k(C),u=h(C,"TEXTAREA",{class:!0}),m(u).forEach(d),C.forEach(d),E=k(D),v=h(D,"DIV",{class:!0});var R=m(v);O=h(R,"DIV",{style:!0});var ee=m(O);T=h(ee,"LABEL",{class:!0});var K=m(T);F=B(K,`Optimize:
						`),A=h(K,"INPUT",{style:!0,type:!0,title:!0}),K.forEach(d),ee.forEach(d),U=k(R),N=h(R,"BUTTON",{class:!0,title:!0});var te=m(N);X=B(te,"Run on carc.in"),te.forEach(d),R.forEach(d),D.forEach(d),z.forEach(d),S.forEach(d),this.h()},h(){b(o,"class","bigInput svelte-1igr68f"),M(o,"error",r[3]),b(l,"class","column svelte-1igr68f"),u.readOnly=!0,b(u,"class","bigInput svelte-1igr68f"),M(u,"error",r[3]),W(A,"align-self","center"),b(A,"type","checkbox"),b(A,"title","Optimization will merge similar structs. Making it smaller but also more difficult to maintain."),b(T,"class","optimizeText svelte-1igr68f"),W(O,"display","flex"),W(O,"align-content","center"),N.disabled=L=r[3]||r[0].length===0||r[2]||r[4].length===0,b(N,"class","carcBtn svelte-1igr68f"),b(N,"title","WARNING: This will send the input to carc.in, please remove private info beforehand."),b(v,"class","actions svelte-1igr68f"),b(g,"class","column svelte-1igr68f"),b(e,"class","overlay svelte-1igr68f"),b(t,"class","svelte-1igr68f")},m(f,S){pe(f,t,S),a(t,e),a(e,l),a(l,n),a(n,s),a(s,i),a(n,y),a(n,o),H(o,r[0]),a(e,j),a(e,g),a(g,_),a(_,c),a(c,w),a(_,I),a(_,u),H(u,r[4]),a(g,E),a(g,v),a(v,O),a(O,T),a(T,F),a(T,A),A.checked=r[1],a(v,U),a(v,N),a(N,X),G||(Q=[P(o,"input",r[6]),P(u,"input",r[7]),P(A,"change",r[8]),P(N,"click",r[9])],G=!0)},p(f,[S]){S&1&&H(o,f[0]),S&8&&M(o,"error",f[3]),S&16&&H(u,f[4]),S&8&&M(u,"error",f[3]),S&2&&(A.checked=f[1]),S&29&&L!==(L=f[3]||f[0].length===0||f[2]||f[4].length===0)&&(N.disabled=L)},i:re,o:re,d(f){f&&d(t),G=!1,he(Q)}}}function le(r){let t=!0;try{const e=JSON.parse(r);(typeof e.push=="function"||typeof e!="object")&&(t=!1)}catch{t=!1}return t}function Oe(r,t,e){let l,n,s="",i=!0,y=!1;function o(I){var v,O;const u=(O=(v=I.match(/struct (?<struct>O_.+)\n/))==null?void 0:v.groups)==null?void 0:O.struct,E=['require "json"',`${I}`];return E.push(`input = <<-JSON
${JSON.stringify(JSON.parse(s))}
JSON`),E.push(`pp ${u}.from_json(input)`),E.join(`

`)}async function j(I){var E,v;e(2,y=!0);const u=await fetch("https://play.crystal-lang.org/run_requests",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({run_request:{language:"crystal",version:"1.1.1",code:o(I)}})}).then(O=>O.json());e(2,y=!1),(v=(E=u==null?void 0:u.run_request)==null?void 0:E.run)!=null&&v.html_url&&window.open(u.run_request.run.html_url,"_blank").focus()}function g(){s=this.value,e(0,s)}function _(){l=this.value,e(4,l),e(0,s),e(1,i)}function c(){i=this.checked,e(1,i)}const w=()=>j(l);return r.$$.update=()=>{r.$$.dirty&3&&e(4,l=s.length>0&&le(s)?ge(s,i):s.length===0?"":"Invalid JSON"),r.$$.dirty&1&&e(3,n=s.length>0&&!le(s))},[s,i,y,n,l,j,g,_,c,w]}class Se extends ue{constructor(t){super();ce(this,t,Oe,ye,fe,{})}}export{Se as default};
